<html>

<head>
    <title>shooter</title>
    <style>
        #player1 {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: blue;
        }
    </style>
</head>


<body>
    <div id="player1" />
    <script>
        // Create WebSocket connection.
        var wsUrl = new URL('', window.location.href);
        wsUrl.protocol = wsUrl.protocol.replace('http', 'ws');
        wsUrl.port = 9206;
        const socket = new WebSocket(wsUrl.href);

        // Connection opened
        socket.addEventListener("open", (event) => {
            // socket.send("Hello Server!");
        });

        // Listen for messages
        socket.addEventListener("message", (event) => {
            console.log("Message from server ", event.data);
            const gameState = JSON.parse(event.data);
            for (const player of gameState.players) {
                const playerDiv = document.getElementById(player.id);
                playerDiv.style.left = `${player.x}px`;
                playerDiv.style.top = `${player.y}px`;
            }
        });

        function sendAction(action) {
            socket.send(JSON.stringify({
                player: "player1",
                action: action
            }));
        }
        document.onkeydown = function (ev) {
            if (ev.key == "ArrowDown" || ev.key == "s") {
                sendAction("down");
            }
            if (ev.key == "ArrowUp" || ev.key == "w") {
                sendAction("up");
            }
            if (ev.key == "ArrowLeft" || ev.key == "a") {
                sendAction("left");
            }
            if (ev.key == "ArrowRight" || ev.key == "d") {
                sendAction("right");
            }

        }
    </script>
</body>

</html>